title: PubManifest processing test suite
date: 2019-11-09
# This entry should be changed to the URL referring to this directory; will be used to generate the final URL-s for each test
url: http://localhost:8001/LocalData/github/Publishing/PubManifest/tests/
tests:
    -   section: §2. Publication Manifest
        ref: 'https://www.w3.org/TR/pub-manifest/#manifest'
        tests:
            -   id: 0
                description: Basic, correct manifest, usable to test the local setup
                actions: Output the manifest
                errors: none
    -   section: §2.4 Manifest contexts
        ref: https://www.w3.org/TR/pub-manifest/#manifest-context
        tests:
            -   id: 2401
                description: Missing Context
                actions: Return empty
                errors: Fatal error on missing context
            -   id: 2402
                description: context incomplete
                actions: Return empty
                errors: Fatal error on missing context

    -   section: §2.5 Manifest Language and Direction
        ref: https://www.w3.org/TR/pub-manifest/#manifest-lang-dir
        tests:
            -   id: 2501
                description: Set valid global language value
                actions: Language en set for all strings
                errors:  none
            -   id: 2502
                description: Set invalid global language value
                actions: No effect on output (value ignored)
                errors: Validation error on incorrect BCP47 value
            -   id: 2503
                description: Set valid global direction value
                actions: Direction ltr set for all strings
                errors: none
            -   id: 2504
                description: Set invalid global direction value
                actions: No effect on output (value ignored)
                errors: Validation error on incorrect base direction value
            -   id: 2505
                description: Out of several (valid) language and direction setting, pick the last one
                actions: Strings should be set with language:en and direction:ltr
                errors: none
    -   section: §2.6 Publication types
        ref: https://www.w3.org/TR/pub-manifest/#profile-types
        tests:
            -   id: 2601
                description: No type set
                actions: The CreativeWork type should be added
                errors: Validation error (no type)
            -   id: 2602
                description: CreativeWork type is not set, only Book
                actions: no change on the document
                errors: None
    -   section: §2.7 Profile Conformance
        ref: https://www.w3.org/TR/pub-manifest/#profile-conformance
        tests:
            -   id: 2701
                description: No conformance at all
                actions: Set profile to user agents default
                errors: Validation error on missing conformance
            -   id: 2702
                description: No known conformance value
                actions: Set profile to user agents default
                errors: Validation error on no known conformance
            -   id: 2703
                description: Non-default conformance value
                actions: Set profile to the audiobooks profile value
                errors: none
    -   section: §2.8.1.1 Abridged
        ref: https://www.w3.org/TR/pub-manifest/#abridged
        tests:
            -   id: 281101
                description: Check invalid value for abridged
                actions: The value of abridged should be removed from the result
                Expected error: Validation error on abridged
    -   section: §2.8.1.2. Accessibility
        ref: https://www.w3.org/TR/pub-manifest/#accessibility
        tests:
            -   id: 281201
                description: Check the simple a11y terms
                actions: All values should be turned into arrays of literals
                Expected error: none
            -   id: 281202
                description: Invalid accessModeSufficient value
                actions: The illegal value (visual) should be removed
                Expected error: Validation error on the incorrect data
            -   id: 281203
                description: All values of accessModeSufficient are invalid
                actions: Both values being invalid, the key should be removed altogether
                Expected error: Validation error on the incorrect data
    -   section: §2.8.1.3 Address
        description: https://www.w3.org/TR/pub-manifest/#address
        tests:
            -   id: 281301
                description: Turn relative URL into absolute
                actions: Value of URL should be absolute
                Expected error: none
            -   id: 281302
                description: Turn all relative URLs into absolute
                actions: Value of all URLs should be absolute
                Expected error: none
            -   id: 281303
                description: Invalid URL
                actions: The invalid URL should be removed
                Expected error: Validation error on the URL
    -   section: §2.8.1.4 Canonical Identifier
        ref: https://www.w3.org/TR/pub-manifest/#canonical-identifier
        tests:
            -   id: 281401
                description: Invalid URL for ID
                actions: Value of invalid URL should be removed
                Expected error: Validation error on the URL
            -   id: 281402
                description: Missing ID
                actions: Output unchanged
                Expected error: Validation error on the missing ID
    -   section: §2.8.1.6 Duration
        ref: https://www.w3.org/TR/pub-manifest/#duration
        tests:
            -   id: 281601
                description: Incorrect duration format
                actions: Duration should be removed from output
                errors: Validation error on incorrect duration format
            -   id: 281602
                description: Correct duration
                actions: Duration value should be present in the output
                errors: none
            -   id: 281603
                description: Incorrect duration format in a linked resource
                actions: Duration should be removed from output
                errors: Validation error on incorrect duration format
            -   id: 281604
                description: Correct duration format in a linked resource
                actions: Duration value should be present in the output
                errors: none
    -   section:
            - §2.8.1.7 Last Modification Date
            - §2.8.1.7 Publication Date
        ref:
            - https://www.w3.org/TR/pub-manifest/#last-modification-date
            - https://www.w3.org/TR/pub-manifest/#publication-date
        tests:
            -   id: 281701
                description: Incorrect date format
                actions: datePublished and dateModified should be removed from output
                errors: incorrect publication dates
            -   id: 281702
                description: Correct date formats
                actions: datePublished and dateModified values should be present in the output
                errors: none
    -   section: §2.8.2.1 Default Reading Order
        ref: https://www.w3.org/TR/pub-manifest/#default-reading-order
        tests:
            -   id: 282101
                description: A single resource is turned into an array of Linked Resources
                actions: readingOrder is an array of a single object, with the URL turned into absolute
                errors: none
            -   id: 282102
                description: Invalid URL is removed from reading order list
                actions: The second entry in readingOrder is removed from the final list
                errors: Validation error on invalid URL, and a validation error on removing the corresponding Linked Resource
            -   id: 282103
                description: missing readingOrder is replaced by a default
                actions: A readingOrder is added with a single link set to the HTML Nodes Document.URL. If none provided, validation error
                errors: Validation error on invalid URL, and a validation error on removing the corresponding Linked Resource
            -   id: 282104
                description: Repeated URLs generate warning but stay in the list
                actions: The output does not change
                errors: Validation error on repeated URLs
    -   section: §2.8.2.2 Resource List
        ref: https://www.w3.org/TR/pub-manifest/#resource-list
        tests:
            -   id: 282201
                description: A single resource is turned into an array of Linked Resources
                actions: Resources is an array of a single object, with the URL turned into absolute
                errors: none
            -   id: 282202
                description: Invalid URL is removed from resources
                actions: The second entry in resources is removed from the final list
                errors: Validation error on invalid URL
            -   id: 282203
                description: duplicate URL-s removed from resources
                actions: The third entry in resources is removed from the final list
                errors: Validation error on invalid URL
    -   section: §2.8.2.3 Links
        ref: https://www.w3.org/TR/pub-manifest/#links
        tests:
            -   id: 282301
                description: A single resource is turned into an array of Linked Resources
                actions: Links is an array of a single object, with the URL turned into absolute
                errors: none
            -   id: 282302
                description: Invalid URL is removed from reading order list
                actions: The second entry in links is removed from the final list
                errors: Validation error on invalid URL
            -   id: 282303
                description: entry in links appears in reading order
                actions: chapter1.html is removed from  links
                errors: Validation error on a link appearing in bounds
            -   id: 282304
                description: Entries in links appear in resources and in reading order, the latter with a fragment id. One of the entry in links is with a fragment, but should yield an error nevertheless
                actions: The chapter1.html, link1.html, and link3.html are removed from  links
                errors: Validation error on a link appearing in bounds
            -   id: 282305
                description: Cover page, toc reference, or pagelist reference should not appear in links
                actions: The links2.html, links4.html, and links6.html entries should be removed from the final links; others should be listed.
                errors: Validation error on all three faulty links.
            -   id: 282306
                description: No rel value set in a resource in links
                actions: Output should be unchanged
                errors: Validation error on missing link.
    -   section: §2.8.3.2 Additional Manifest Properties
        ref: https://www.w3.org/TR/pub-manifest/#extensibility-manifest-properties
        tests:
            -   id: 283201
                description: Extra term values with, possibly, extra namespace declaration is accepted
                actions: The manifest should leave the extra values in the output
                errors: none
            -   id: 283202
                description: Extra term values in entities and in linked resources should be accepted in the output
                actions: The manifest should leave the extra values in the output
                errors: none
    -   section: §2.9.1.1 Cover
        ref: https://www.w3.org/TR/pub-manifest/#cover
        tests:
            -   id: 291101
                description: There should not be a repeated definition of cover
                actions: The second occurrence of cover should be flagged
                errors: Validation error on cover
            -   id: 291102
                description: A cover referring to an image should have a name
                actions: Validation error generation
                errors: Validation error on missing name
            -   id: 291103
                description: A cover referring to a non-image without a name is fine
                actions: No change on the output
                errors: None
    -   section: §2.9.1.2 Page List
        ref: https://www.w3.org/TR/pub-manifest/#page-list
        tests:
            -   id: 291201
                description: There should not be a repeated definition of page list
                actions: The second occurrence of page list should be flagged
                errors: Validation error on page list
    -   section: §2.9.1.3 Page List
        ref: https://www.w3.org/TR/pub-manifest/#pub-table-of-contents
        tests:
            -   id: 291301
                description: There should not be a repeated definition of TOC
                actions: The second occurrence of TOC should be flagged
                errors: Validation error on TOC
    -   section: §3 Publication resources
        ref: https://www.w3.org/TR/pub-manifest/#publication-resources
        tests:
            -   id: 301
                description: Calculation of bounds removes fragment identifiers
                actions: The uniqueResources array contains URL-s without fragments
                errors: none
            -   id: 302
                description: Calculation of bounds removes duplicate entries
                actions: The uniqueResources array contains unique URL-s only
                errors: none
    -   section: §4 Manifest Discovery
        ref: https://www.w3.org/TR/pub-manifest/#manifest-discovery
        tests:
            -   id: 401
                format: html
                description: Retrieve a manifest linked from the primary entry point
                actions: The separate manifest file (link_401.jsonld) should be processed and generated
                errors: none
            -   id: 402
                format: html
                description: Retrieve the manifest from the primary entry point's script element
                actions: The embedded manifest should be processed and generated
                errors: none
            -   id: 403
                format: html
                description: Reuse the title for the (missing) name entry
                actions: The embedded manifest should be processed and generated with an additional name
                errors: none
            -   id: 404
                format: html
                description: Reuse the title for the (missing) name entry, with language and direction set
                actions: The embedded manifest should be processed and generated with an additional name
                errors: none
            -   id: 405
                format: html
                description: Reuse the document URL to set the reading order
                actions: The embedded manifest should be processed and generated with the reading order set to the HTML's URL. The value should also be present in the uniqueResources array.
                errors: none
            -   id: 406
                format: html
                description: No name and no title to reuse
                actions: A "no title" name should be added
                errors: Validation error on a missing default title
    -   section: §5. Audio Manifest
        ref: https://www.w3.org/TR/audiobooks/#audio-manifest
        tests:
            -   id: 1
                description: Minimum audio manifest
                actions: Output the manifest
                errors: none
